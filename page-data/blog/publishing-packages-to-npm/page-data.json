{
    "componentChunkName": "component---src-templates-blog-post-index-js",
    "path": "/blog/publishing-packages-to-npm/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jlozovei.dev","siteUrl":"https://jlozovei.dev"}},"markdownRemark":{"html":"<p>The base of JavaScript development today is <em>collaboration</em>, we all know that. A person from other country can solve your problem by simply creating a package and sharing it on npm - and you can do it too!</p>\n<p>When you use a npm package in your project, you need to keep in mind that you’re using other persons’ piece of code, and you expect that it would not break your code, nor steal your information. So, if you want to publish a package on npm, you need to follow the same.</p>\n<blockquote>\n<p>npm has some <a href=\"https://www.npmjs.com/policies\">policies</a> to prevent “bad packages”.</p>\n</blockquote>\n<p>Also, you expect that the code does what it says it does - not less, not more; either if you’re using a simple routing package or a complete framework. And, how to guarantee it? With tests, obviously!</p>\n<p>So, within the 3 paragraphs above we encountereed a lot of “rules” we need to follow if we want to publish a package on npm. I mean “rules” and not <strong>rules</strong> because they’re conventions - you can publish an empty package without tests too, but, how does it will help people?</p>\n<h3>Published Packages</h3>\n<p>While working for Bcredi, I noticed that we were using the same piece of code in 3 or 4 different projects. The same piece of code with the same piece of tests - it was clearly an example of <em>“how not to <a href=\"https://github.com/dwmkerr/hacker-laws#the-dry-principle\">DRY</a>”</em>.</p>\n<p>If the validation changed, we must change it on all projects, redo the tests… A great headache at all.</p>\n<p>To solve it, and as an opportunity to study about publishing packages - before that, I haven’t published any packages - I decided to create packages for those repeated pieces. This way, we centralize the code and the tests - if we need to change anything, we do it in only one place and update the versions.</p>\n<p>The 2 packages are:</p>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/@jlozovei/trim-currency\">@jlozovei/trim-currency</a></li>\n<li><a href=\"https://www.npmjs.com/package/@jlozovei/format-money\">@jlozovei/format-money</a></li>\n</ul>\n<p>But, before accomplishing the publication, I had to learn some stuff.</p>\n<h3>How to publish a package?</h3>\n<p>If you create a new project by running <code class=\"language-text\">npm init -y</code>, create a new <code class=\"language-text\">index.js</code> file and then run <code class=\"language-text\">npm publish</code>, you can say that you’ve published a package. Even if the package does nothing, it’ll be a published package.</p>\n<p>But, the goal here is to help people, and an empty package like this won’t help anybody.</p>\n<p>So, as a beginner on the subject, I started to research about publishing packages. And I found 2 glorious resources that helped me through this process:</p>\n<ul>\n<li><a href=\"https://zellwk.com/blog/publish-to-npm/\">“How to publish packages to npm (the way the industry does things)”, by Zell Liew</a></li>\n<li><a href=\"https://egghead.io/courses/how-to-write-an-open-source-javascript-library\">“How to Write an Open Source JavaScript Library”, a course by Kent C. Dodds at Egghead.io</a></li>\n</ul>\n<p>Going straight to the core, after viewing these two nice resources I’ve learned some nice tips on how to publish a package on npm. And, basically, all of those tips can be compiled into 4 topics:</p>\n<ol>\n<li>Create the project</li>\n<li>Set up some tests</li>\n<li>Create a CI track</li>\n<li>Semantic Versioning</li>\n</ol>\n<h4>1. Create the project</h4>\n<p>It’s quite obvious, but we need to create a new project. You create a repository on your favorite VSC platform (GitHub, Bitbucket, GitLab…), and commit every change on it.</p>\n<p>It’d be nice if you use a pattern for your commits, so this way the release process will be much easier. There are a lot of nice tools to help you standartize your commits, like <a href=\"https://github.com/commitizen/cz-cli\">commitizen</a> or <a href=\"https://github.com/conventional-changelog/conventional-changelog\">conventional-changelog</a>.</p>\n<p>A great point here is to tell npm to ignore some files, using a <code class=\"language-text\">.npmignore</code> file. It’s useful to avoid some files to be published within your package, like test cases, examples and documentations. When you run <code class=\"language-text\">npm install &lt;some_package></code> on your terminal, all the files that are in the npm registry will be downloaded on your machine - and we don’t want to waste band and memory on unused files.</p>\n<blockquote>\n<p>You can always take a look on the <a href=\"https://docs.npmjs.com/using-npm/developers.html\">npm developer guide</a>!</p>\n</blockquote>\n<h4>2. Set up some tests</h4>\n<p>After the work is done, you must ensure your code will be able to be used, and also that it’s working perfectly. You can use a lot of stuff to create your tests. I use <a href=\"https://github.com/facebook/jest\">jest</a> a lot because it’s easy and simple to use.</p>\n<p>Also, you can set up a coverage status - it’ll tell how much of your code is covered by the tests, and will ensure that your code is reliable. There are a lot of coverage tools as well, and I like to use <a href=\"http://codecov.io/\">codecov</a> on my projects. <em>codecov</em> will read the coverage reports from your test framework and will generate reports about that coverage, showing where the code was tested and were it wasn’t.</p>\n<h4>3. Create a CI track</h4>\n<p>As a developer, I hate to do repeatable jobs. And I’m sure you hate it too.</p>\n<blockquote>\n<p>Leave all the repeatable work for the machines.</p>\n</blockquote>\n<p>Creating a CI track will help you to test and publish your package. There are a lot of good CI tools, like <a href=\"https://travis-ci.org/\">Travis</a>, <a href=\"https://circleci.com/\">CircleCI</a> and the newest <a href=\"https://github.com/features/actions\">GitHub Actions</a>. Basically, the <code class=\"language-text\">CI</code> (or Continuous Integration) is a machine that will execute some of your project’s scripts to test and deploy the code. If anything goes wrong, it’ll tell you where are the errors and stop the process - it won’t deploy buggy code.</p>\n<h4>4. Semantic Versioning</h4>\n<p>Semantic versioning, or <em>semver</em> is a convention defined for establishing new versions of your code. Those versions will based on the changes you’ve made. The changes can be divided on three categories, by definition:</p>\n<ul>\n<li><strong>Major</strong>: a change that will break the code (<code class=\"language-text\">1.0.0</code> to <code class=\"language-text\">2.0.0</code>).</li>\n<li><strong>Minor</strong>: a change that add a new feature, with backwards compatibility (<code class=\"language-text\">1.0.0</code> to <code class=\"language-text\">1.1.0</code>).</li>\n<li><strong>Patch</strong>: a change that fixes some bugs, with backwards compatibility (<code class=\"language-text\">1.0.0</code> to <code class=\"language-text\">1.0.1</code>).</li>\n</ul>\n<blockquote>\n<p>You can learn more about <a href=\"https://semver.org/\">semver here</a>.</p>\n</blockquote>\n<p>All of it will be handle by the CI track we’ve set up, with the help of an automator. The most famous automators are <a href=\"https://github.com/sindresorhus/np\">np</a> and <a href=\"https://github.com/semantic-release/semantic-release\">semantic-release</a>.</p>\n<p>With <code class=\"language-text\">np</code> you can choose the version by yourself; with <code class=\"language-text\">semantic-release</code>, the version will be chosen by the changes you’ve made (with the help of <code class=\"language-text\">conventional-changelog</code>).</p>\n<p>By doing those 4 steps, we guarantee the code quality and we’re secured to be publishing a nice package.</p>","timeToRead":5,"frontmatter":{"date":"04/06/2020","title":"Publishing packages to npm","category":"tutorial","excerpt":"Let's publish some packages to npm!"},"fields":{"langKey":"en","slug":"/blog/publishing-packages-to-npm/"}}},"pageContext":{"id":"40e1a306-72a2-5035-828c-b19ae2fc7d0a"}},
    "staticQueryHashes": ["1946181227"]}